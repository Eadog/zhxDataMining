# zhxDataMining
药物虚拟筛选是一种利用计算机辅助方法来预测和评估潜在药物分子与靶点之间相互作用的过程。它是一种高效的药物发现方法，可以在大量候选分子中筛选出具有潜在治疗效果的化合物，从而节省时间和成本。
药物虚拟筛选通常涉及以下几个主要步骤：
1. **目标选择**：首先，确定需要治疗的疾病或病理目标，例如蛋白质、酶或受体。这些目标可能与特定疾病的发生、发展或传播有关。
2. **化合物数据库**：准备一个包含大量化合物结构信息的数据库。这些化合物可以是已知的药物、天然产物或者由计算机模拟生成的新化合物。
3. **虚拟筛选方法**：选择适当的虚拟筛选方法。这些方法可以分为结构基础的和药效基础的。结构基础的方法利用分子结构、物理性质和构象信息来预测分子与靶点的亲和性和特异性。药效基础的方法则利用已知的生物活性数据和药物-靶点相互作用信息来预测新化合物的活性。
4. **筛选和评估**：应用虚拟筛选方法对化合物数据库进行筛选，识别与目标结合的候选化合物。然后，使用分子对接、分子动力学模拟等技术对候选化合物进行评估，评估它们的亲和性、特异性、药效等性质。
5. **实验验证**：最后，通过实验验证筛选出的候选化合物的活性和生物效应。这可能涉及体外和体内实验，以确认候选化合物的治疗效果和毒副作用。

## 数据集内容
### 蛋白质序列（protein sequence）FASTA：
MQSTSNHLWLLSDILGQGATANVFRGRHKKTGDLFAIKVFNNISFLRPVDVQMREFEVLKKLNHKNIVKLFAIEEETTTRHKVLIMEFCPCGSLYTVLEEPSNA
蛋白质的二级结构：
在空间上的局部折叠形态，有氨基酸残基间的氢键形成的稳定结构成。蛋白质的二级结构通常分为a-螺旋、β-折叠和无规则三种主要的类型。
蛋白质的三级结构：
三级结构就是指整条多肽链的三维结构，
包括了主链骨架以及侧链在内的所有
原子的空间结构。

### 配体SMILES：
CS(=O)(=O)c1cc(C#N)ccc1[C@H]1NC(=O)N(c2cccc(C(F)(F)F)c2)C2=C1C(=O)CC2

![image](https://github.com/Eadog/zhxDataMining/assets/148857552/a62b8c7b-5633-43b1-89c8-666b9367d3f9)

### 蛋白质蛋白质口袋是指蛋白质分子表面上的一些凹陷或者孔洞，这些区域通常与蛋白质的
生物活性相关联。蛋白质口袋可以与其他分子发生相互作用，从而影响其生物活性。

## 模型结构
### CAPLA模型

![image](https://github.com/Eadog/zhxDataMining/assets/148857552/434906a7-b21e-481c-99ca-dc7769321438)

该模型的输入有三个部分：蛋白质序列、蛋白质口袋序列、配体SMILES
嵌入层。 三个特征提取部分中的每一个都包含一个线性嵌入层。 嵌入层的作用是将稀疏的one-hot向量转换为稠密向量，并将口袋和配体输入表示统一到与交叉注意机制的输入相同的维度。 在这里，蛋白质、口袋和配体的每个输入表示都被送入嵌入层以获得 128D 密集向量。 因此，我们分别获得了每个蛋白质、口袋和配体大小为 1000 128、63 128 和 150 128 的嵌入矩阵。 

交叉注意力机制。 交叉注意力机制最初用于 Transformer 中，以允许解码器中的每个位置覆盖输入序列中的整个位置（Vaswani 等人，2017）。 随后，它被广​​泛应用于各种任务，例如 图像文本分类和机器翻译。 这些应用程序展示了交叉注意机制，能够在两个单独的输入之间构建显式交互，以充分利用它们的相关性。 受此特征的启发，我们采用交叉注意机制来交叉提取蛋白质结合袋和配体的特征。 此外，基于注意力分数矩阵，交叉注意力机制可以捕获口袋和配体之间的量化相互作用，并为模型的可解释性提供支持，以揭示潜在的预测机制。 
![image](https://github.com/Eadog/zhxDataMining/assets/148857552/1ad2f92c-ea3f-460b-9b64-773fa9652868)

膨胀卷积：
膨胀卷积其实是通过扩大卷积核尺寸的方式来增大感受野，同时既没有增大计算量，也没有降低特征图的分辨率。

优点：
在保持参数数量不变的情况下，能够增加每个神经元的感受野大小。使模型可以捕获更
广阔的空间信息，从而在一个卷积层中同时捕获局部和全局信息。更好的理解输入序列
中的上下文信息。

![image](https://github.com/Eadog/zhxDataMining/assets/148857552/31c21d93-6e51-41a5-b948-aa324631d364)

### DrugBAN

![image](https://github.com/Eadog/zhxDataMining/assets/148857552/30376af1-5449-42fa-afc4-d4308b544e2a)
双线性注意力网络
双线性注意力网络（Bilinear Attention Network）是一种神经网络结构，通常用于处理视觉问答（Visual Question Answering，VQA）等任务。它利用双线性池化操作来建模图像和问题之间的复杂关系，从而实现更好的视觉与语言融合。
双线性注意力网络的主要思想和工作原理：
1. **输入**：
   - 双线性注意力网络的输入通常包括一张图像和一个问题。图像通常是通过卷积神经网络（CNN）提取的特征图，而问题则是经过自然语言处理（NLP）技术编码的向量表示。
2. **特征提取**：
   - 图像特征和问题特征分别经过特征提取网络，以获取它们的表示。图像特征通常通过卷积神经网络提取，而问题特征则通过循环神经网络（RNN）或者注意力机制进行编码。
3. **双线性池化**：
   - 双线性池化是双线性操作的一种形式，它通过将两个输入向量的外积计算出一个矩阵，并对其进行池化操作来建模它们之间的复杂关系。
   - 在双线性注意力网络中，双线性池化操作被用来融合图像和问题的特征表示，从而获取它们之间的相关性。这有助于网络更好地理解图像和问题之间的语义关系。
4. **注意力机制**：
   - 双线性池化操作产生的特征矩阵通常被送入一个注意力机制，用来计算每个图像空间位置和问题词汇之间的注意力分布。这个注意力分布指示了图像中哪些区域和问题中哪些词汇对于回答问题更重要。
5. **融合和预测**：
   - 最后，通过将注意力加权的图像特征和问题特征进行融合，得到一个综合的表示，然后将其送入全连接层进行最终的问题回答预测。

该模型的特色之处:
1.通过双线性注意力机制捕获药物和目标之间的成对局部相互作用
2.通过双线性注意力权重而不是黑盒结果给出可解释的预测结果
3.通过对抗域适应方法增强跨域泛化

条件域对抗网络（CDAN）：
有两组数据，比如猫的图片和狗的图片，但问题是这两组数据的特征分布有些不同。现在你想训练一个模型，让它能够正确地区分猫和狗的图片。但由于数据的特征分布不同，模型可能在处理一组数据时效果好，而在处理另一组数据时效果差。
CDAN 的核心思想是让模型在学习的过程中，同时考虑到数据的标签信息和数据的来源信息（也就是所谓的域）。通过引入一个“领域分类器”，模型可以学会如何区分不同来源的数据，然后再通过对抗性训练来尽量减小不同来源数据之间的差异。

![image](https://github.com/Eadog/zhxDataMining/assets/148857552/f5e13897-4cd7-4072-9e3a-ca1c9eeea8c5)




